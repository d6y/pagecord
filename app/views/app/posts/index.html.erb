<div class="mx-auto max-w-2xl w-full text-slate-950 dark:text-slate-50">
  <div class="my-8">

    <p class="mb-8">
      <% if @posts.empty? %>
        <div class="sm:flex gap-4">
          <div class="sm:flex-1 sm:min-w-0">
            <p>
              You'll see your posts here once you start posting ✨
            </p>
            <p class="mt-4 break-words">
              To publish a new post, send an email from <span class="bg-yellow-100 rounded dark:bg-slate-700 px-1"><%= @blog.user.email %></span> to <%= mail_to @blog.delivery_email, class: "underline font-semibold" %> or click the New Post button.
            </p>
          </div>
          <div class="mt-4 sm:mt-0 sm:flex-shrink-0 text-end sm:w-30">
            <%= link_to "✏️ New Post", new_app_post_path, class: "btn-primary", title: "Start writing a new post" %>
          </div>
        </div>
      <% else %>
        <%= render "app/shared/callout" do %>
          You have written <%= pluralize @pagy.count, "post" %>. Click on the title to edit an existing post,
          or <%= link_to "create a new post", new_app_post_path, class: "font-medium underline" %>
        <% end %>

        <div data-controller="search">
          <div class="flex items-center justify-end gap-2 mb-4">
            <button data-action="click->search#toggle" class="p-2 text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100 transition-colors cursor-pointer" title="Search posts">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
              </svg>
            </button>
            <%= link_to "✏️ New Post", new_app_post_path, class: "btn-primary", title: "Start writing a new post" %>
          </div>

          <div data-search-target="container" class="<%= 'hidden' unless @search_term %> mb-8">
            <%= form_with url: app_posts_path, method: :get, local: true, data: { turbo_frame: "posts", search_target: "form", turbo_action: "advance" } do |form| %>
              <div class="relative">
                <%= form.text_field :search, value: @search_term, placeholder: "Search posts...",
                    data: { action: "input->search#search keydown->search#handleKeydown", search_target: "input" },
                    class: "w-full px-4 py-2 pr-12 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 placeholder-slate-500 dark:placeholder-slate-400 focus:outline-none focus:ring-0 focus:border-slate-500 dark:focus:border-slate-400" %>
                <button type="button" data-action="click->search#toggle" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 transition-colors" title="Close search">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                  </svg>
                </button>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>
    </p>

    <%= turbo_frame_tag "posts" do %>
      <%= render "posts_list" %>
      <%= render "app/shared/pagy_nav" %>
    <% end %>
  </div>
</div>
